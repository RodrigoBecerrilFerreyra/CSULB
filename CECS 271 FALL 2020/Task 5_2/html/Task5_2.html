
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Task5_2</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-10-28"><meta name="DC.source" content="Task5_2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Copyright</a></li><li><a href="#2">Problem 1</a></li><li><a href="#3">Problem 2</a></li><li><a href="#4">Problem 3</a></li><li><a href="#5">Problem 4</a></li></ul></div><h2 id="1">Copyright</h2><pre class="codeinput">close <span class="string">all</span>; format <span class="string">compact</span>; clc;
fprintf(<span class="string">"Engineer: Rodrigo Becerril Ferreyra\n"</span>);
fprintf(<span class="string">"Company: California State University, Long Beach\n"</span>);
fprintf(<span class="string">"Project Name: Task 5.2\n"</span>);
fprintf(<span class="string">"Date: 20 October 2020\n"</span>);
</pre><pre class="codeoutput">Engineer: Rodrigo Becerril Ferreyra
Company: California State University, Long Beach
Project Name: Task 5.2
Date: 20 October 2020
</pre><h2 id="2">Problem 1</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 1\n"</span>);
clear <span class="string">variables</span>;

x = [0.9, 1.3, 1.9, 2.1, 2.6, 3.0, 3.9, 4.4, 4.7, 5.0, 6.0, 7.0, 8.0, 9.2, 10.5, 11.3, 11.6, 12.0, 12.6 13.0, 13.3];
y = [1.3, 1.5, 1.85, 2.1, 2.6, 2.7, 2.4, 2.15, 2.05, 2.1, 2.25, 2.3, 2.25, 1.95, 1.4, 0.9, 0.7, 0.6, 0.5, 0.4, 0.25];
z = linspace(x(1), x(end), 1001);
spl = spline(x, y);

figure(); hold <span class="string">on</span>;

interpol = plot(z, ppval(spl, z), <span class="string">"Color"</span>, [0 0.5 0]);
points = plot(x, y, <span class="string">'b.'</span>, <span class="string">"Markersize"</span>, 10);
grid <span class="string">on</span>;
legend([points, interpol], [<span class="string">"Data points"</span>, <span class="string">"Interpolation"</span>], <span class="string">"Location"</span>, <span class="string">"southwest"</span>);
title(<span class="string">"Spline Interpolation"</span>);

hold <span class="string">off</span>;

fprintf(<span class="string">"%2s\t%4s\t%4s\t%6s\t%6s\t%6s\t%6s\n"</span>, <span class="string">"#"</span>, <span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>);
fprintf(<span class="string">"%2d\t%4.2f\t%4.2f\t%6s\t%6s\t%6s\t%6s\n"</span>, 1, x(1), y(1), <span class="string">"N/A"</span>, <span class="string">"N/A"</span>, <span class="string">"N/A"</span>, <span class="string">"N/A"</span>);
<span class="keyword">for</span> i = 2:(length(x)-1)
    a = spl.coefs(i, 1); b = spl.coefs(i, 2); c = spl.coefs(i, 3); d = spl.coefs(i, 4);
    fprintf(<span class="string">"%2d\t%4.2f\t%4.2f\t%6.3f\t%6.3f\t%6.3f\t%6.3f\n"</span>, i, x(i), y(i), a, b, c, d);
<span class="keyword">end</span>
</pre><pre class="codeoutput">
Problem 1
 #	   x	   y	     a	     b	     c	     d
 1	0.90	1.30	   N/A	   N/A	   N/A	   N/A
 2	1.30	1.50	 0.773	-0.071	 0.348	 1.500
 3	1.90	1.85	-2.789	 1.321	 1.097	 1.850
 4	2.10	2.10	-0.458	-0.353	 1.291	 2.100
 5	2.60	2.60	 0.449	-1.040	 0.594	 2.600
 6	3.00	2.70	 0.174	-0.502	-0.023	 2.700
 7	3.90	2.40	 0.078	-0.032	-0.503	 2.400
 8	4.40	2.15	 1.314	 0.085	-0.477	 2.150
 9	4.70	2.05	-1.581	 1.268	-0.071	 2.050
10	5.00	2.10	 0.043	-0.155	 0.262	 2.100
11	6.00	2.25	-0.005	-0.026	 0.081	 2.250
12	7.00	2.30	-0.024	-0.040	 0.015	 2.300
13	8.00	2.25	 0.017	-0.113	-0.139	 2.250
14	9.20	1.95	-0.013	-0.051	-0.336	 1.950
15	10.50	1.40	-0.020	-0.100	-0.532	 1.400
16	11.30	0.90	 1.209	-0.149	-0.731	 0.900
17	11.60	0.70	-0.828	 0.940	-0.494	 0.700
18	12.00	0.60	 0.012	-0.054	-0.139	 0.600
19	12.60	0.50	-0.296	-0.032	-0.190	 0.500
20	13.00	0.40	-0.296	-0.387	-0.357	 0.400
</pre><img vspace="5" hspace="5" src="Task5_2_01.png" alt=""> <h2 id="3">Problem 2</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 2\n"</span>);
clear <span class="string">a</span> <span class="string">b</span> <span class="string">c</span> <span class="string">d</span> <span class="string">i</span> <span class="string">interpol</span> <span class="string">points</span>;

f_z = zeros(1, length(z));
ip = 1:length(x);

<span class="comment">% z_lagrange = lagrange polynomial evaluated at z</span>
<span class="comment">% textbook page 154</span>
<span class="keyword">for</span> index = 1:length(z)
    <span class="keyword">for</span> i = ip
        j = find(ip~=i);
        product = y(ip(i));
        <span class="keyword">for</span> k = j
            product = product * (z(index) - x(ip(k)))/(x(ip(i)) - x(ip(k)));
        <span class="keyword">end</span>
        f_z(index) = f_z(index) + product;
    <span class="keyword">end</span>
<span class="keyword">end</span>

figure(); hold <span class="string">on</span>;

interpol = plot(z, ppval(spl, z), <span class="string">"Color"</span>, [0 0.5 0]);
lagrange = plot(z, f_z, <span class="string">"r-"</span>);
points = plot(x, y, <span class="string">'b.'</span>, <span class="string">"Markersize"</span>, 10);
grid <span class="string">on</span>;
legend([points, interpol, lagrange], [<span class="string">"Data points"</span>, <span class="string">"Spline"</span>, <span class="string">"Lagrange"</span>], <span class="string">"Location"</span>, <span class="string">"southwest"</span>);
title(<span class="string">"Spline/Lagrangian Interpolation"</span>);

hold <span class="string">off</span>;
</pre><pre class="codeoutput">
Problem 2
</pre><img vspace="5" hspace="5" src="Task5_2_02.png" alt=""> <h2 id="4">Problem 3</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 3\n"</span>);
clear <span class="string">variables</span>;

x = 0:6;
y = [0.135, 0.479, 0.763, 0.905, 0.964, 0.987, 0.995];

A = [2*sum(x.^4), 2*sum(x.^3), 2*sum(x.^2); 2*sum(x.^3), 2*sum(x.^2), 2*sum(x); 2*sum(x.^2), 2*sum(x), 2];
b = [2*sum((x.^2) .* y); 2*sum(x.*y); 2*sum(y)];

temp = A \ b; a = temp(1); b = temp(2); c = temp(3); clear <span class="string">temp</span>;
fprintf(<span class="string">"a = %f\n"</span>, a);
fprintf(<span class="string">"b = %f\n"</span>, b);
fprintf(<span class="string">"c = %f\n"</span>, c);

figure(); hold <span class="string">on</span>;

domain = linspace(0, 6, 100);
f = @(x) a.*x.^2 + b.*x + c;
line = plot(domain, f(domain), <span class="string">'r-'</span>);
points = plot(x, y, <span class="string">'b.'</span>, <span class="string">"Markersize"</span>, 10);
grid <span class="string">on</span>;
legend([points, line], [<span class="string">"Data points"</span>, <span class="string">"Quadratic of best fit"</span>], <span class="string">"Location"</span>, <span class="string">"southeast"</span>);
title(<span class="string">"Polynomial of Best Fit (Order 2)"</span>);
text(1, f(1), <span class="string">"$$\leftarrow y = ax^2 + bx + c$$"</span>, <span class="string">"Interpreter"</span>, <span class="string">"latex"</span>);

hold <span class="string">off</span>;

TSE = sum((f(x) - y).^2);
fprintf(<span class="string">"TSE = %f\n"</span>, TSE);
</pre><pre class="codeoutput">
Problem 3
a = -0.052760
b = 0.479610
c = -0.042693
TSE = 0.054675
</pre><img vspace="5" hspace="5" src="Task5_2_03.png" alt=""> <h2 id="5">Problem 4</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 4\n"</span>);
clear <span class="string">variables</span>;

A = [1, 3, -4; 2, -2, 1]; B = [3, -2; -1, 4; -2, 5];
r = sum(sum(A*B));
fprintf(<span class="string">"(a) %f\n"</span>, r);

A = [2, 3, 5; 4, -2, -1; 0, 4, 2]; B = [1 2 4; -3 2 0; 5 4 5; 1 5 -2];
r = sum(B*A);
fprintf(<span class="string">"(b) %f\n"</span>, r(2));

v = 1:2:5; w = 3:-2:-1;
A = [v-w; w.^2 - v.^-1; w.^v - v.^w];
fprintf(<span class="string">"(c) ["</span>); fprintf(<span class="string">"%f "</span>, A(2, :)); fprintf(<span class="string">"]\n"</span>);

A = [1 2 3; 4 5 6; 7 8 9];
v = diag(A, 0);
fprintf(<span class="string">"(d) ["</span>); fprintf(<span class="string">"%f "</span>, v); fprintf(<span class="string">"]'\n"</span>);

k = 1:3; A = [k; k.^2; k.^3]; B = A.^-1/A;
r = sum(diag(B));
fprintf(<span class="string">"(e) %f\n"</span>, r);

B = [1 2 3; 5 4 1; -3 6 2];
s = sum(diag(B(1:3, 3:-1:1)));
fprintf(<span class="string">"(f) %f\n"</span>, s);

k = 1:16; A = k'*k; B = A.^1.5./(A.^2 - 99);
r = sum(diag(B)) + sum(diag(B(1:16, 16:-1:1)));
fprintf(<span class="string">"(g) %f\n"</span>, r);

A = [1 2 3; 4 6 5; 3 -1 2]; B = [3 2; 2 1; 1 -1];
C = 2*B'*A + 2*(A*B)' - 3*(A'*B)';
fprintf(<span class="string">"(h)\n"</span>); disp(C); fprintf(<span class="string">"\n"</span>);

<span class="comment">% sum(A(:)) = 0 -&gt; r^2 - 2r + 1 = 0</span>
r = roots([1, -2, 1]);
fprintf(<span class="string">"(i) %f\n"</span>, r(1));

<span class="comment">% 1+2 = 3, 2+1 = 3, these are all the combinations</span>
a = 1:2; b = 2:-1:1;
A = [1 -2 3; 3 -4 1; 6 -2 3];
reverseA = A(:, end:-1:1);
s = sum(diag(reverseA, -1)) + sum(diag(reverseA, 1));
fprintf(<span class="string">"(j) %f\n"</span>, s);

k = 1:10; A = k'*((k-pi)./(k+pi));
reverseA = A(:, end:-1:1);
s = sum(diag(reverseA, -8)) + sum(diag(reverseA, -6)) + sum(diag(reverseA, -4)) + sum(diag(reverseA, -2)) + sum(diag(reverseA, 0)) + sum(diag(reverseA, 2)) + sum(diag(reverseA, 4)) + sum(diag(reverseA, 6)) + sum(diag(reverseA, 8));
fprintf(<span class="string">"(k) %f\n"</span>, s);
</pre><pre class="codeoutput">
Problem 4
(a) -3.000000
(b) 14.000000
(c) [8.000000 0.666667 0.800000 ]
(d) [1.000000 5.000000 9.000000 ]'
(e) 0.749228
(f) 4.000000
(g) 3.005601
(h)
     6    41    -3
    -1     7    -3

(i) 1.000000
(j) 0.000000
(k) 45.752071
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Copyright

close all; format compact; clc;
fprintf("Engineer: Rodrigo Becerril Ferreyra\n");
fprintf("Company: California State University, Long Beach\n");
fprintf("Project Name: Task 5.2\n");
fprintf("Date: 20 October 2020\n");

%% Problem 1
fprintf("\nProblem 1\n");
clear variables;

x = [0.9, 1.3, 1.9, 2.1, 2.6, 3.0, 3.9, 4.4, 4.7, 5.0, 6.0, 7.0, 8.0, 9.2, 10.5, 11.3, 11.6, 12.0, 12.6 13.0, 13.3];
y = [1.3, 1.5, 1.85, 2.1, 2.6, 2.7, 2.4, 2.15, 2.05, 2.1, 2.25, 2.3, 2.25, 1.95, 1.4, 0.9, 0.7, 0.6, 0.5, 0.4, 0.25];
z = linspace(x(1), x(end), 1001);
spl = spline(x, y);

figure(); hold on;

interpol = plot(z, ppval(spl, z), "Color", [0 0.5 0]);
points = plot(x, y, 'b.', "Markersize", 10);
grid on;
legend([points, interpol], ["Data points", "Interpolation"], "Location", "southwest");
title("Spline Interpolation");

hold off;

fprintf("%2s\t%4s\t%4s\t%6s\t%6s\t%6s\t%6s\n", "#", "x", "y", "a", "b", "c", "d");
fprintf("%2d\t%4.2f\t%4.2f\t%6s\t%6s\t%6s\t%6s\n", 1, x(1), y(1), "N/A", "N/A", "N/A", "N/A");
for i = 2:(length(x)-1)
    a = spl.coefs(i, 1); b = spl.coefs(i, 2); c = spl.coefs(i, 3); d = spl.coefs(i, 4);
    fprintf("%2d\t%4.2f\t%4.2f\t%6.3f\t%6.3f\t%6.3f\t%6.3f\n", i, x(i), y(i), a, b, c, d);
end

%% Problem 2
fprintf("\nProblem 2\n");
clear a b c d i interpol points;

f_z = zeros(1, length(z));
ip = 1:length(x);

% z_lagrange = lagrange polynomial evaluated at z
% textbook page 154
for index = 1:length(z)
    for i = ip
        j = find(ip~=i);
        product = y(ip(i));
        for k = j
            product = product * (z(index) - x(ip(k)))/(x(ip(i)) - x(ip(k)));
        end
        f_z(index) = f_z(index) + product;
    end
end

figure(); hold on;

interpol = plot(z, ppval(spl, z), "Color", [0 0.5 0]);
lagrange = plot(z, f_z, "r-");
points = plot(x, y, 'b.', "Markersize", 10);
grid on;
legend([points, interpol, lagrange], ["Data points", "Spline", "Lagrange"], "Location", "southwest");
title("Spline/Lagrangian Interpolation");

hold off;

%% Problem 3
fprintf("\nProblem 3\n");
clear variables;

x = 0:6;
y = [0.135, 0.479, 0.763, 0.905, 0.964, 0.987, 0.995];

A = [2*sum(x.^4), 2*sum(x.^3), 2*sum(x.^2); 2*sum(x.^3), 2*sum(x.^2), 2*sum(x); 2*sum(x.^2), 2*sum(x), 2];
b = [2*sum((x.^2) .* y); 2*sum(x.*y); 2*sum(y)];

temp = A \ b; a = temp(1); b = temp(2); c = temp(3); clear temp;
fprintf("a = %f\n", a);
fprintf("b = %f\n", b);
fprintf("c = %f\n", c);

figure(); hold on;

domain = linspace(0, 6, 100);
f = @(x) a.*x.^2 + b.*x + c;
line = plot(domain, f(domain), 'r-');
points = plot(x, y, 'b.', "Markersize", 10);
grid on;
legend([points, line], ["Data points", "Quadratic of best fit"], "Location", "southeast");
title("Polynomial of Best Fit (Order 2)");
text(1, f(1), "$$\leftarrow y = ax^2 + bx + c$$", "Interpreter", "latex");

hold off;

TSE = sum((f(x) - y).^2);
fprintf("TSE = %f\n", TSE);

%% Problem 4
fprintf("\nProblem 4\n");
clear variables;

A = [1, 3, -4; 2, -2, 1]; B = [3, -2; -1, 4; -2, 5];
r = sum(sum(A*B));
fprintf("(a) %f\n", r);

A = [2, 3, 5; 4, -2, -1; 0, 4, 2]; B = [1 2 4; -3 2 0; 5 4 5; 1 5 -2];
r = sum(B*A);
fprintf("(b) %f\n", r(2));

v = 1:2:5; w = 3:-2:-1;
A = [v-w; w.^2 - v.^-1; w.^v - v.^w];
fprintf("(c) ["); fprintf("%f ", A(2, :)); fprintf("]\n");

A = [1 2 3; 4 5 6; 7 8 9];
v = diag(A, 0);
fprintf("(d) ["); fprintf("%f ", v); fprintf("]'\n");

k = 1:3; A = [k; k.^2; k.^3]; B = A.^-1/A;
r = sum(diag(B));
fprintf("(e) %f\n", r);

B = [1 2 3; 5 4 1; -3 6 2];
s = sum(diag(B(1:3, 3:-1:1)));
fprintf("(f) %f\n", s);

k = 1:16; A = k'*k; B = A.^1.5./(A.^2 - 99);
r = sum(diag(B)) + sum(diag(B(1:16, 16:-1:1)));
fprintf("(g) %f\n", r);

A = [1 2 3; 4 6 5; 3 -1 2]; B = [3 2; 2 1; 1 -1];
C = 2*B'*A + 2*(A*B)' - 3*(A'*B)';
fprintf("(h)\n"); disp(C); fprintf("\n");

% sum(A(:)) = 0 -> r^2 - 2r + 1 = 0
r = roots([1, -2, 1]);
fprintf("(i) %f\n", r(1));

% 1+2 = 3, 2+1 = 3, these are all the combinations
a = 1:2; b = 2:-1:1;
A = [1 -2 3; 3 -4 1; 6 -2 3];
reverseA = A(:, end:-1:1);
s = sum(diag(reverseA, -1)) + sum(diag(reverseA, 1));
fprintf("(j) %f\n", s);

k = 1:10; A = k'*((k-pi)./(k+pi));
reverseA = A(:, end:-1:1);
s = sum(diag(reverseA, -8)) + sum(diag(reverseA, -6)) + sum(diag(reverseA, -4)) + sum(diag(reverseA, -2)) + sum(diag(reverseA, 0)) + sum(diag(reverseA, 2)) + sum(diag(reverseA, 4)) + sum(diag(reverseA, 6)) + sum(diag(reverseA, 8));
fprintf("(k) %f\n", s);

##### SOURCE END #####
--></body></html>