
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Task5</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-10-21"><meta name="DC.source" content="Task5.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Copyright</a></li><li><a href="#2">Problem 1</a></li><li><a href="#3">Problem 2</a></li><li><a href="#4">Problem 3</a></li><li><a href="#5">Problem 4</a></li><li><a href="#6">Problem 5</a></li><li><a href="#7">Problem 6</a></li><li><a href="#8">Problem 7</a></li><li><a href="#9">Problem 8</a></li></ul></div><h2 id="1">Copyright</h2><pre class="codeinput">close <span class="string">all</span>; format <span class="string">compact</span>; clc;
fprintf(<span class="string">"Engineer: Rodrigo Becerril Ferreyra\n"</span>);
fprintf(<span class="string">"Company: California State University, Long Beach\n"</span>);
fprintf(<span class="string">"Project Name: Task 5\n"</span>);
fprintf(<span class="string">"Date: 20 October 2020\n"</span>);
</pre><pre class="codeoutput">Engineer: Rodrigo Becerril Ferreyra
Company: California State University, Long Beach
Project Name: Task 5
Date: 20 October 2020
</pre><h2 id="2">Problem 1</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 1\n"</span>);
clear <span class="string">variables</span>;

x = [0,  2, 5];
y = [0, -1, 5];
domain = linspace(0, 5, 101);
f = @(z) (z.^2 - 3.*z)./2; <span class="comment">% See picture for work</span>

figure(); hold <span class="string">on</span>;
line = plot(domain, f(domain), <span class="string">'r-'</span>);
points = plot(x, y, <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);
title(<span class="string">"Manual Interpolation Calculation"</span>);
legend([points, line], [<span class="string">"Data points"</span>, <span class="string">"Interpolation"</span>], <span class="string">"Location"</span>, <span class="string">"northwest"</span>);
text(3.1, 0, <span class="string">"$$\leftarrow f(z) = \frac{z^2 - 3z}{2}$$"</span>, <span class="string">"Interpreter"</span>, <span class="string">"latex"</span>);
grid <span class="string">on</span>;
hold <span class="string">off</span>;

fprintf(<span class="string">"The interpolating function is (z^2 - 3*z)/2.\n"</span>);
</pre><pre class="codeoutput">
Problem 1
The interpolating function is (z^2 - 3*z)/2.
</pre><img vspace="5" hspace="5" src="Task5_01.png" alt=""> <h2 id="3">Problem 2</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 2\n"</span>);
clear <span class="string">variables</span>;

<span class="comment">% Given</span>
x = 0:10;
y = x.^2 + 3.*x + 2;
sample_points = [1/2, 3/2, 5/2];

<span class="comment">% See fencepost problem; we need N-1 lines</span>
<span class="comment">% Also we need to put function handles in a cell array (not a matrix)</span>
lines = cell(1, length(x)-1);
<span class="keyword">for</span> i = 1:(length(x)-1)

    <span class="comment">% Lagrange (1st degree) polynomial</span>
    lines{i} = @(z) (z - x(i+1))./(x(i) - x(i+1)) .* y(i) + (z - x(i))./(x(i+1) - x(i)) .* y(i+1);

<span class="keyword">end</span>

figure(); hold <span class="string">on</span>;

<span class="comment">% Plot all of the lines</span>
<span class="keyword">for</span> i = 1 : length(lines)

    domain = linspace(x(i), x(i+1), 11);
    l = plot(domain, lines{i}(domain), <span class="string">'r-'</span>);

<span class="keyword">end</span>
p = plot(x, y, <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);
grid <span class="string">on</span>;
title(<span class="string">"Linear Interpolation Between Points"</span>);
legend([p, l], [<span class="string">"Data points"</span>, <span class="string">"Interpolating lines"</span>], <span class="string">"Location"</span>, <span class="string">"northwest"</span>);

hold <span class="string">off</span>;

<span class="keyword">for</span> i = 1:3

    experimental = lines{i}(sample_points(i));
    actual = sample_points(i).^2 + 3.*sample_points(i) + 2;
    fprintf(<span class="string">"Relative error of approximating f(%3.1f): %f%%\n"</span>, sample_points(i), 100*abs(experimental - actual)/actual);

<span class="keyword">end</span>
</pre><pre class="codeoutput">
Problem 2
Relative error of approximating f(0.5): 6.666667%
Relative error of approximating f(1.5): 2.857143%
Relative error of approximating f(2.5): 1.587302%
</pre><img vspace="5" hspace="5" src="Task5_02.png" alt=""> <h2 id="4">Problem 3</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 3\n"</span>);
clear <span class="string">variables</span>;

c = polyfit([0, pi/2, pi], [0, 1, 0], 2);
fprintf(<span class="string">"The polynomial that goes through the points (0, 0), (pi/2, 1), and (pi, 0) is\n"</span>);
fprintf(<span class="string">"f(x) = %fx^2 + %fx + %f\n"</span>, c(1), c(2), c(3));
fprintf(<span class="string">"More precisely, f(x) = (-4/pi^2)x^2 + (4/pi)x; see attached image"</span>);

figure(); hold <span class="string">on</span>;

domain = linspace(0, pi, 101);
line = plot(domain, polyval(c, domain), <span class="string">'r-'</span>);
points = plot([0, pi/2, pi], [0, 1, 0], <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);
legend([points, line], [<span class="string">"Data points"</span>, <span class="string">"Interpolation"</span>], <span class="string">"Location"</span>, <span class="string">"south"</span>);
grid <span class="string">on</span>;
title(<span class="string">"Interpolation Using polyfit"</span>);
axis([0, pi, -0.2, 1.0625]);
set(gca,<span class="string">'XTick'</span>,0:pi/4:pi); set(gca,<span class="string">'XTickLabel'</span>,{<span class="string">'0'</span>, <span class="string">'\pi/4'</span>, <span class="string">'\pi/2'</span>, <span class="string">'3\pi/4'</span>, <span class="string">'\pi'</span>});
text(pi/8, polyval(c, pi/8), <span class="string">"$$\leftarrow f(z) = \frac{-4\left(z^2 - \pi z\right)}{\pi^2}$$"</span>, <span class="string">"Interpreter"</span>, <span class="string">"latex"</span>);

hold <span class="string">off</span>;
</pre><pre class="codeoutput">
Problem 3
The polynomial that goes through the points (0, 0), (pi/2, 1), and (pi, 0) is
f(x) = -0.405285x^2 + 1.273240x + -0.000000
More precisely, f(x) = (-4/pi^2)x^2 + (4/pi)x; see attached image</pre><img vspace="5" hspace="5" src="Task5_03.png" alt=""> <h2 id="5">Problem 4</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 4\n"</span>);
clear <span class="string">variables</span>;

figure(); hold <span class="string">on</span>;
interpol = @(z) (-8.*z.^3 + 8*pi^2.*z)./(3*pi^3); <span class="comment">% see attached image</span>
domain = linspace(-pi/2, pi, 101);
lines = plot(domain, interpol(domain), <span class="string">'r-'</span>);
points = plot([-pi/2, 0, pi/2, pi], [-1, 0, 1, 0], <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);
set(gca,<span class="string">'XTick'</span>,-pi/2:pi/4:pi); set(gca,<span class="string">'XTickLabel'</span>,{<span class="string">'-\pi/2'</span>, <span class="string">'-\pi/4'</span>, <span class="string">'0'</span>, <span class="string">'\pi/4'</span>, <span class="string">'\pi/2'</span>, <span class="string">'3\pi/4'</span>, <span class="string">'\pi'</span>});
axis([-pi/2, pi, -interpol(pi/sqrt(3)), interpol(pi/sqrt(3))]);
legend([points, lines], [<span class="string">"Data points"</span>, <span class="string">"Interpolation"</span>], <span class="string">"Location"</span>, <span class="string">"southeast"</span>);
grid <span class="string">on</span>;
title(<span class="string">"Manual Interpolation Calculation"</span>)
text(-pi/4, interpol(-pi/4), <span class="string">"$$\leftarrow f(z) = \frac{-8z^{3}+8\pi^{2}z}{3\pi^{3}}$$"</span>, <span class="string">"Interpreter"</span>, <span class="string">"latex"</span>);

hold <span class="string">off</span>;

fprintf(<span class="string">"The interpolating function is f(z) = (-8z^3 + 8pi^2*z)/(3pi^3).\n"</span>);
</pre><pre class="codeoutput">
Problem 4
The interpolating function is f(z) = (-8z^3 + 8pi^2*z)/(3pi^3).
</pre><img vspace="5" hspace="5" src="Task5_04.png" alt=""> <h2 id="6">Problem 5</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 5\n"</span>);
clear <span class="string">variables</span>;

x = [-pi, -pi/2, 0, pi/2, pi];
y = [0, -1, 0, 1, 0];
figure(); hold <span class="string">on</span>;

domain = -pi:pi/20:pi;
lines = plot(domain, spline(x, y, domain), <span class="string">'r-'</span>);
points = plot(x, y, <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);

grid <span class="string">on</span>;
legend([points, lines], [<span class="string">"Data points"</span>, <span class="string">"Interpolation"</span>], <span class="string">"Location"</span>, <span class="string">"southeast"</span>);
title(<span class="string">"Interpolation Using spline"</span>);
set(gca,<span class="string">'XTick'</span>,-pi:pi/2:pi); set(gca,<span class="string">'XTickLabel'</span>,{<span class="string">'-\pi'</span>, <span class="string">'-\pi/2'</span>, <span class="string">'0'</span>, <span class="string">'\pi/2'</span>, <span class="string">'\pi'</span>});

hold <span class="string">off</span>;
</pre><pre class="codeoutput">
Problem 5
</pre><img vspace="5" hspace="5" src="Task5_05.png" alt=""> <h2 id="7">Problem 6</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 6\n"</span>);
clear <span class="string">variables</span>;

x = 0 : 0.1 : 1;
y = [3.16, 3.01, 2.73, 2.47, 2.13, 1.82, 1.52, 1.21, 0.76, 0.43, 0.03];

ab = [sum(sin(x).^2), sum(sin(x).*cos(x)); sum(cos(x).*sin(x)), sum(cos(x).^2)] \ [sum(y.*sin(x)); sum(y.*cos(x))];
a = ab(1); b = ab(2); clear <span class="string">ab</span>;

figure(); hold <span class="string">on</span>;

f = @(x) a.*sin(x) + b.*cos(x);
func = plot(x, f(x), <span class="string">'r-'</span>);
points = plot(x, y, <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);
grid <span class="string">on</span>;
legend([points, func], [<span class="string">"Data points"</span>, <span class="string">"$$y=a\sin(x) + b\cos(x)$$"</span>], <span class="string">"Location"</span>, <span class="string">"southwest"</span>, <span class="string">"Interpreter"</span>, <span class="string">"latex"</span>)
text([0.025, 0.025], [1.5, 1], [sprintf(<span class="string">"$$a = %f$$"</span>, a), sprintf(<span class="string">"$$b = %f$$"</span>, b)], <span class="string">"Interpreter"</span>, <span class="string">"latex"</span>);
title(<span class="string">"Line of Best Fit Approximation"</span>);

hold <span class="string">off</span>;
</pre><pre class="codeoutput">
Problem 6
</pre><img vspace="5" hspace="5" src="Task5_06.png" alt=""> <h2 id="8">Problem 7</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 7\n"</span>);
clear <span class="string">variables</span>;

x = [-pi, -pi/2, 0, pi/2, pi];
y = [0, -1, 0, 1, 0];
figure(); hold <span class="string">on</span>;

domain = -pi:pi/20:pi;
s = spline(x, y, domain);
f = sin(domain);
spline_ = plot(domain, s, <span class="string">'r-'</span>);
func = plot(domain, f, <span class="string">'g-'</span>);
points = plot(x, y, <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);

grid <span class="string">on</span>;
legend([points, spline_, func], [<span class="string">"Data points"</span>, <span class="string">"Interpolation"</span>, <span class="string">"$$y=\sin(x)$$"</span>], <span class="string">"Location"</span>, <span class="string">"southeast"</span>, <span class="string">"Interpreter"</span>, <span class="string">"latex"</span>);
title(<span class="string">"Interpolation Using spline Compared to Original Function"</span>);
set(gca,<span class="string">'XTick'</span>,-pi:pi/2:pi); set(gca,<span class="string">'XTickLabel'</span>,{<span class="string">'-\pi'</span>, <span class="string">'-\pi/2'</span>, <span class="string">'0'</span>, <span class="string">'\pi/2'</span>, <span class="string">'\pi'</span>});

hold <span class="string">off</span>;

fprintf(<span class="string">"The sum of the squared errors over the (discretely-defined) domain is %f\n"</span>, sum((s - f).^2));
</pre><pre class="codeoutput">
Problem 7
The sum of the squared errors over the (discretely-defined) domain is 0.389921
</pre><img vspace="5" hspace="5" src="Task5_07.png" alt=""> <h2 id="9">Problem 8</h2><pre class="codeinput">fprintf(<span class="string">"\nProblem 8\n"</span>);
clear <span class="string">variables</span>;

fprintf(<span class="string">"f(x) = x^3 + sin(x) - 1\n"</span>);
x = 1:11+1;
f = x.^3 + sin(x) - 1;
c = polyfit(x, f, length(x)-1);

fprintf(<span class="string">"f(4.5) = %f\n"</span>, polyval(c, 4.5));
fprintf(<span class="string">"f(15) = %f\n"</span>, polyval(c, 15));

figure(); hold <span class="string">on</span>;

domain = linspace(0, 15, 101);
lines = plot(domain, polyval(c, domain), <span class="string">'r-'</span>);
points = plot(x, f, <span class="string">'b.'</span>, <span class="string">"MarkerSize"</span>, 20);
wanted = plot([4.5, 15], [polyval(c, 4.5), polyval(c, 15)], <span class="string">'g.'</span>, <span class="string">"MarkerSize"</span>, 20);

grid <span class="string">on</span>; axis([0, 15, -1, polyval(c, 15)]);
title(<span class="string">"Interpolation and Extrapolation"</span>);
legend([points, lines, wanted], [<span class="string">"Data points"</span>, <span class="string">"Interpolation/Extrapolation"</span>, <span class="string">"Interesting points"</span>], <span class="string">"Location"</span>, <span class="string">"northwest"</span>);

hold <span class="string">off</span>;
</pre><pre class="codeoutput">
Problem 8
f(x) = x^3 + sin(x) - 1
Warning: Polynomial is badly conditioned. Add points with distinct X values,
reduce the degree of the polynomial, or try centering and scaling as described
in HELP POLYFIT. 
f(4.5) = 89.147466
f(15) = 3336.280580
</pre><img vspace="5" hspace="5" src="Task5_08.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Copyright

close all; format compact; clc;
fprintf("Engineer: Rodrigo Becerril Ferreyra\n");
fprintf("Company: California State University, Long Beach\n");
fprintf("Project Name: Task 5\n");
fprintf("Date: 20 October 2020\n");

%% Problem 1
fprintf("\nProblem 1\n");
clear variables;

x = [0,  2, 5];
y = [0, -1, 5];
domain = linspace(0, 5, 101);
f = @(z) (z.^2 - 3.*z)./2; % See picture for work

figure(); hold on;
line = plot(domain, f(domain), 'r-');
points = plot(x, y, 'b.', "MarkerSize", 20);
title("Manual Interpolation Calculation");
legend([points, line], ["Data points", "Interpolation"], "Location", "northwest");
text(3.1, 0, "$$\leftarrow f(z) = \frac{z^2 - 3z}{2}$$", "Interpreter", "latex");
grid on;
hold off;

fprintf("The interpolating function is (z^2 - 3*z)/2.\n");

%% Problem 2
fprintf("\nProblem 2\n");
clear variables;

% Given
x = 0:10;
y = x.^2 + 3.*x + 2;
sample_points = [1/2, 3/2, 5/2];

% See fencepost problem; we need N-1 lines
% Also we need to put function handles in a cell array (not a matrix)
lines = cell(1, length(x)-1);
for i = 1:(length(x)-1)

    % Lagrange (1st degree) polynomial
    lines{i} = @(z) (z - x(i+1))./(x(i) - x(i+1)) .* y(i) + (z - x(i))./(x(i+1) - x(i)) .* y(i+1);

end

figure(); hold on;

% Plot all of the lines
for i = 1 : length(lines)

    domain = linspace(x(i), x(i+1), 11);
    l = plot(domain, lines{i}(domain), 'r-');

end
p = plot(x, y, 'b.', "MarkerSize", 20);
grid on;
title("Linear Interpolation Between Points");
legend([p, l], ["Data points", "Interpolating lines"], "Location", "northwest");

hold off;

for i = 1:3

    experimental = lines{i}(sample_points(i));
    actual = sample_points(i).^2 + 3.*sample_points(i) + 2;
    fprintf("Relative error of approximating f(%3.1f): %f%%\n", sample_points(i), 100*abs(experimental - actual)/actual);

end

%% Problem 3
fprintf("\nProblem 3\n");
clear variables;

c = polyfit([0, pi/2, pi], [0, 1, 0], 2);
fprintf("The polynomial that goes through the points (0, 0), (pi/2, 1), and (pi, 0) is\n");
fprintf("f(x) = %fx^2 + %fx + %f\n", c(1), c(2), c(3));
fprintf("More precisely, f(x) = (-4/pi^2)x^2 + (4/pi)x; see attached image");

figure(); hold on;

domain = linspace(0, pi, 101);
line = plot(domain, polyval(c, domain), 'r-');
points = plot([0, pi/2, pi], [0, 1, 0], 'b.', "MarkerSize", 20);
legend([points, line], ["Data points", "Interpolation"], "Location", "south");
grid on;
title("Interpolation Using polyfit");
axis([0, pi, -0.2, 1.0625]);
set(gca,'XTick',0:pi/4:pi); set(gca,'XTickLabel',{'0', '\pi/4', '\pi/2', '3\pi/4', '\pi'});
text(pi/8, polyval(c, pi/8), "$$\leftarrow f(z) = \frac{-4\left(z^2 - \pi z\right)}{\pi^2}$$", "Interpreter", "latex");

hold off;

%% Problem 4
fprintf("\nProblem 4\n");
clear variables;

figure(); hold on;
interpol = @(z) (-8.*z.^3 + 8*pi^2.*z)./(3*pi^3); % see attached image
domain = linspace(-pi/2, pi, 101);
lines = plot(domain, interpol(domain), 'r-');
points = plot([-pi/2, 0, pi/2, pi], [-1, 0, 1, 0], 'b.', "MarkerSize", 20);
set(gca,'XTick',-pi/2:pi/4:pi); set(gca,'XTickLabel',{'-\pi/2', '-\pi/4', '0', '\pi/4', '\pi/2', '3\pi/4', '\pi'});
axis([-pi/2, pi, -interpol(pi/sqrt(3)), interpol(pi/sqrt(3))]);
legend([points, lines], ["Data points", "Interpolation"], "Location", "southeast");
grid on;
title("Manual Interpolation Calculation")
text(-pi/4, interpol(-pi/4), "$$\leftarrow f(z) = \frac{-8z^{3}+8\pi^{2}z}{3\pi^{3}}$$", "Interpreter", "latex");

hold off;

fprintf("The interpolating function is f(z) = (-8z^3 + 8pi^2*z)/(3pi^3).\n");

%% Problem 5
fprintf("\nProblem 5\n");
clear variables;

x = [-pi, -pi/2, 0, pi/2, pi];
y = [0, -1, 0, 1, 0];
figure(); hold on;

domain = -pi:pi/20:pi;
lines = plot(domain, spline(x, y, domain), 'r-');
points = plot(x, y, 'b.', "MarkerSize", 20);

grid on;
legend([points, lines], ["Data points", "Interpolation"], "Location", "southeast");
title("Interpolation Using spline");
set(gca,'XTick',-pi:pi/2:pi); set(gca,'XTickLabel',{'-\pi', '-\pi/2', '0', '\pi/2', '\pi'});

hold off;

%% Problem 6
fprintf("\nProblem 6\n");
clear variables;

x = 0 : 0.1 : 1;
y = [3.16, 3.01, 2.73, 2.47, 2.13, 1.82, 1.52, 1.21, 0.76, 0.43, 0.03];

ab = [sum(sin(x).^2), sum(sin(x).*cos(x)); sum(cos(x).*sin(x)), sum(cos(x).^2)] \ [sum(y.*sin(x)); sum(y.*cos(x))];
a = ab(1); b = ab(2); clear ab;

figure(); hold on;

f = @(x) a.*sin(x) + b.*cos(x);
func = plot(x, f(x), 'r-');
points = plot(x, y, 'b.', "MarkerSize", 20);
grid on;
legend([points, func], ["Data points", "$$y=a\sin(x) + b\cos(x)$$"], "Location", "southwest", "Interpreter", "latex")
text([0.025, 0.025], [1.5, 1], [sprintf("$$a = %f$$", a), sprintf("$$b = %f$$", b)], "Interpreter", "latex");
title("Line of Best Fit Approximation");

hold off;

%% Problem 7
fprintf("\nProblem 7\n");
clear variables;

x = [-pi, -pi/2, 0, pi/2, pi];
y = [0, -1, 0, 1, 0];
figure(); hold on;

domain = -pi:pi/20:pi;
s = spline(x, y, domain);
f = sin(domain);
spline_ = plot(domain, s, 'r-');
func = plot(domain, f, 'g-');
points = plot(x, y, 'b.', "MarkerSize", 20);

grid on;
legend([points, spline_, func], ["Data points", "Interpolation", "$$y=\sin(x)$$"], "Location", "southeast", "Interpreter", "latex");
title("Interpolation Using spline Compared to Original Function");
set(gca,'XTick',-pi:pi/2:pi); set(gca,'XTickLabel',{'-\pi', '-\pi/2', '0', '\pi/2', '\pi'});

hold off;

fprintf("The sum of the squared errors over the (discretely-defined) domain is %f\n", sum((s - f).^2));

%% Problem 8
fprintf("\nProblem 8\n");
clear variables;

fprintf("f(x) = x^3 + sin(x) - 1\n");
x = 1:11+1;
f = x.^3 + sin(x) - 1;
c = polyfit(x, f, length(x)-1);

fprintf("f(4.5) = %f\n", polyval(c, 4.5));
fprintf("f(15) = %f\n", polyval(c, 15));

figure(); hold on;

domain = linspace(0, 15, 101);
lines = plot(domain, polyval(c, domain), 'r-');
points = plot(x, f, 'b.', "MarkerSize", 20);
wanted = plot([4.5, 15], [polyval(c, 4.5), polyval(c, 15)], 'g.', "MarkerSize", 20);

grid on; axis([0, 15, -1, polyval(c, 15)]);
title("Interpolation and Extrapolation");
legend([points, lines, wanted], ["Data points", "Interpolation/Extrapolation", "Interesting points"], "Location", "northwest");

hold off;

##### SOURCE END #####
--></body></html>